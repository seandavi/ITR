<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Multivariate data analysis: Acute Leukemia</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<link href="site_libs/ionicons-2.0.1/css/ionicons.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">seandavi(s12): Courses and Tutorials</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="setup.html">
    <span class="fa fa-cogs"></span>
     
    setup
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="ion ion-easel"></span>
     
    Slides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="motivation_for_R_slides.html">Motivation for using R</a>
    </li>
    <li>
      <a href="http://bit.ly/bioc_cshl_2019">Introduction to Bioconductor</a>
    </li>
    <li>
      <a href="https://doi.org/10.6084/m9.figshare.8397257.v1">Advanced Bioconductor Overview</a>
    </li>
    <li>
      <a href="MachineLearning.html">Machine Learning hands-on</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-question fa-lg"></span>
     
    Misc.
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="further_resources.html">Further resources</a>
    </li>
    <li>
      <a href="https://github.com/seandavi/ITR">Source code for this site</a>
    </li>
    <li>
      <a href="https://github.com/seandavi/ITR/archive/master.zip">Download materials</a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Multivariate data analysis: Acute Leukemia</h1>

</div>


<div id="all-phenotypic-data" class="section level2">
<h2>ALL Phenotypic Data</h2>
<p>This data comes from an (old) Acute Lymphoid Leukemia microarray data set. The actual data are available at <a href="https://raw.githubusercontent.com/seandavi/ITR/master/ALL-phenoData.csv">THIS LINK</a> or by downloading using R.</p>
<pre class="r"><code>download.file(&#39;https://raw.githubusercontent.com/seandavi/ITR/master/ALL-phenoData.csv&#39;,
              destfile = &#39;ALL-phenoData.csv&#39;)</code></pre>
<p>Choose the file that contains ALL (acute lymphoblastic leukemia) patient information and input the date using <code>read.csv()</code>; for <code>read.csv()</code>, use <code>row.names=1</code> to indicate that the first column contains row names.</p>
<pre class="r"><code>path &lt;- file.choose()    # look for ALL-phenoData.csv</code></pre>
<!--

-->
<pre class="r"><code>stopifnot(file.exists(path))
pdata &lt;- read.csv(path, row.names=1)</code></pre>
<p>Check out the help page <code>?read.delim</code> for input options. The exercises use <code>?read.csv</code>; Can you guess why? Explore basic properties of the object you’ve created, for instance…</p>
<pre class="r"><code>class(pdata)</code></pre>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<pre class="r"><code>colnames(pdata)</code></pre>
<pre><code>##  [1] &quot;cod&quot;            &quot;diagnosis&quot;      &quot;sex&quot;            &quot;age&quot;           
##  [5] &quot;BT&quot;             &quot;remission&quot;      &quot;CR&quot;             &quot;date.cr&quot;       
##  [9] &quot;t.4.11.&quot;        &quot;t.9.22.&quot;        &quot;cyto.normal&quot;    &quot;citog&quot;         
## [13] &quot;mol.biol&quot;       &quot;fusion.protein&quot; &quot;mdr&quot;            &quot;kinet&quot;         
## [17] &quot;ccr&quot;            &quot;relapse&quot;        &quot;transplant&quot;     &quot;f.u&quot;           
## [21] &quot;date.last.seen&quot;</code></pre>
<pre class="r"><code>dim(pdata)</code></pre>
<pre><code>## [1] 128  21</code></pre>
<pre class="r"><code>head(pdata)</code></pre>
<pre><code>##        cod diagnosis sex age BT remission CR   date.cr t.4.11. t.9.22.
## 01005 1005 5/21/1997   M  53 B2        CR CR  8/6/1997   FALSE    TRUE
## 01010 1010 3/29/2000   M  19 B2        CR CR 6/27/2000   FALSE   FALSE
## 03002 3002 6/24/1998   F  52 B4        CR CR 8/17/1998      NA      NA
## 04006 4006 7/17/1997   M  38 B1        CR CR  9/8/1997    TRUE   FALSE
## 04007 4007 7/22/1997   M  57 B2        CR CR 9/17/1997   FALSE   FALSE
## 04008 4008 7/30/1997   M  17 B1        CR CR 9/27/1997   FALSE   FALSE
##       cyto.normal        citog mol.biol fusion.protein mdr   kinet   ccr
## 01005       FALSE      t(9;22)  BCR/ABL           p210 NEG dyploid FALSE
## 01010       FALSE  simple alt.      NEG           &lt;NA&gt; POS dyploid FALSE
## 03002          NA         &lt;NA&gt;  BCR/ABL           p190 NEG dyploid FALSE
## 04006       FALSE      t(4;11) ALL1/AF4           &lt;NA&gt; NEG dyploid FALSE
## 04007       FALSE      del(6q)      NEG           &lt;NA&gt; NEG dyploid FALSE
## 04008       FALSE complex alt.      NEG           &lt;NA&gt; NEG hyperd. FALSE
##       relapse transplant               f.u date.last.seen
## 01005   FALSE       TRUE BMT / DEATH IN CR           &lt;NA&gt;
## 01010    TRUE      FALSE               REL      8/28/2000
## 03002    TRUE      FALSE               REL     10/15/1999
## 04006    TRUE      FALSE               REL      1/23/1998
## 04007    TRUE      FALSE               REL      11/4/1997
## 04008    TRUE      FALSE               REL     12/15/1997</code></pre>
<pre class="r"><code>summary(pdata$sex)</code></pre>
<pre><code>##    F    M NA&#39;s 
##   42   83    3</code></pre>
<pre class="r"><code>summary(pdata$cyto.normal)</code></pre>
<pre><code>##    Mode   FALSE    TRUE    NA&#39;s 
## logical      69      24      35</code></pre>
<p>Remind yourselves about various ways to subset and access columns of a data.frame</p>
<pre class="r"><code>pdata[1:5, 3:4]</code></pre>
<pre><code>##       sex age
## 01005   M  53
## 01010   M  19
## 03002   F  52
## 04006   M  38
## 04007   M  57</code></pre>
<pre class="r"><code>pdata[1:5, ]</code></pre>
<pre><code>##        cod diagnosis sex age BT remission CR   date.cr t.4.11. t.9.22.
## 01005 1005 5/21/1997   M  53 B2        CR CR  8/6/1997   FALSE    TRUE
## 01010 1010 3/29/2000   M  19 B2        CR CR 6/27/2000   FALSE   FALSE
## 03002 3002 6/24/1998   F  52 B4        CR CR 8/17/1998      NA      NA
## 04006 4006 7/17/1997   M  38 B1        CR CR  9/8/1997    TRUE   FALSE
## 04007 4007 7/22/1997   M  57 B2        CR CR 9/17/1997   FALSE   FALSE
##       cyto.normal       citog mol.biol fusion.protein mdr   kinet   ccr
## 01005       FALSE     t(9;22)  BCR/ABL           p210 NEG dyploid FALSE
## 01010       FALSE simple alt.      NEG           &lt;NA&gt; POS dyploid FALSE
## 03002          NA        &lt;NA&gt;  BCR/ABL           p190 NEG dyploid FALSE
## 04006       FALSE     t(4;11) ALL1/AF4           &lt;NA&gt; NEG dyploid FALSE
## 04007       FALSE     del(6q)      NEG           &lt;NA&gt; NEG dyploid FALSE
##       relapse transplant               f.u date.last.seen
## 01005   FALSE       TRUE BMT / DEATH IN CR           &lt;NA&gt;
## 01010    TRUE      FALSE               REL      8/28/2000
## 03002    TRUE      FALSE               REL     10/15/1999
## 04006    TRUE      FALSE               REL      1/23/1998
## 04007    TRUE      FALSE               REL      11/4/1997</code></pre>
<pre class="r"><code>head(pdata[, 3:5])</code></pre>
<pre><code>##       sex age BT
## 01005   M  53 B2
## 01010   M  19 B2
## 03002   F  52 B4
## 04006   M  38 B1
## 04007   M  57 B2
## 04008   M  17 B1</code></pre>
<pre class="r"><code>tail(pdata[, 3:5], 3)</code></pre>
<pre><code>##        sex age BT
## 65003    M  30 T3
## 83001    M  29 T2
## LAL4  &lt;NA&gt;  NA  T</code></pre>
<pre class="r"><code>head(pdata$age)</code></pre>
<pre><code>## [1] 53 19 52 38 57 17</code></pre>
<pre class="r"><code>head(pdata$sex)</code></pre>
<pre><code>## [1] M M F M M M
## Levels: F M</code></pre>
<pre class="r"><code>head(pdata[pdata$age &gt; 21,])</code></pre>
<pre><code>##        cod diagnosis sex age BT remission CR   date.cr t.4.11. t.9.22.
## 01005 1005 5/21/1997   M  53 B2        CR CR  8/6/1997   FALSE    TRUE
## 03002 3002 6/24/1998   F  52 B4        CR CR 8/17/1998      NA      NA
## 04006 4006 7/17/1997   M  38 B1        CR CR  9/8/1997    TRUE   FALSE
## 04007 4007 7/22/1997   M  57 B2        CR CR 9/17/1997   FALSE   FALSE
## 08001 8001 1/15/1997   M  40 B2        CR CR 3/26/1997   FALSE   FALSE
## 08011 8011 8/21/1998   M  33 B3        CR CR 10/8/1998   FALSE   FALSE
##       cyto.normal        citog mol.biol fusion.protein mdr   kinet   ccr
## 01005       FALSE      t(9;22)  BCR/ABL           p210 NEG dyploid FALSE
## 03002          NA         &lt;NA&gt;  BCR/ABL           p190 NEG dyploid FALSE
## 04006       FALSE      t(4;11) ALL1/AF4           &lt;NA&gt; NEG dyploid FALSE
## 04007       FALSE      del(6q)      NEG           &lt;NA&gt; NEG dyploid FALSE
## 08001       FALSE     del(p15)  BCR/ABL           p190 NEG    &lt;NA&gt; FALSE
## 08011       FALSE del(p15/p16)  BCR/ABL      p190/p210 NEG dyploid FALSE
##       relapse transplant               f.u date.last.seen
## 01005   FALSE       TRUE BMT / DEATH IN CR           &lt;NA&gt;
## 03002    TRUE      FALSE               REL     10/15/1999
## 04006    TRUE      FALSE               REL      1/23/1998
## 04007    TRUE      FALSE               REL      11/4/1997
## 08001    TRUE      FALSE               REL      7/11/1997
## 08011   FALSE       TRUE BMT / DEATH IN CR           &lt;NA&gt;</code></pre>
<p>It seems from below that there are 17 females over 40 in the data set. However, some individuals have <code>NA</code> for the age and / or sex, and these <code>NA</code> values propagate through some computations. Use <code>table()</code> to summarize the number of females over 40, and the number of samples for which this classification cannot be determined. When <em>R</em> encounters an <code>NA</code> value in a subscript index, it introduces an <code>NA</code> into the result. Observe this (rows of <code>NA</code> values introduced into the result) when subsetting using <code>[</code> versus using the <code>subset()</code> function.</p>
<pre class="r"><code>idx &lt;- pdata$sex == &quot;F&quot; &amp; pdata$age &gt; 40
table(idx, useNA=&quot;ifany&quot;)</code></pre>
<pre><code>## idx
## FALSE  TRUE  &lt;NA&gt; 
##   108    17     3</code></pre>
<pre class="r"><code>dim(pdata[idx,])           # WARNING: &#39;NA&#39; rows introduced</code></pre>
<pre><code>## [1] 20 21</code></pre>
<pre class="r"><code>tail(pdata[idx,])</code></pre>
<pre><code>##         cod  diagnosis  sex age   BT remission                 CR
## 49006 49006  8/12/1998    F  43   B2        CR                 CR
## 57001 57001  1/29/1997    F  53   B3      &lt;NA&gt; DEATH IN INDUCTION
## 62001 62001 11/11/1997    F  50   B4       REF                REF
## NA.1   &lt;NA&gt;       &lt;NA&gt; &lt;NA&gt;  NA &lt;NA&gt;      &lt;NA&gt;               &lt;NA&gt;
## 02020  2020  3/23/2000    F  48   T2      &lt;NA&gt; DEATH IN INDUCTION
## NA.2   &lt;NA&gt;       &lt;NA&gt; &lt;NA&gt;  NA &lt;NA&gt;      &lt;NA&gt;               &lt;NA&gt;
##          date.cr t.4.11. t.9.22. cyto.normal         citog mol.biol
## 49006 11/19/1998      NA      NA          NA          &lt;NA&gt;  BCR/ABL
## 57001       &lt;NA&gt;   FALSE   FALSE        TRUE        normal      NEG
## 62001       &lt;NA&gt;   FALSE    TRUE       FALSE t(9;22)+other  BCR/ABL
## NA.1        &lt;NA&gt;      NA      NA          NA          &lt;NA&gt;     &lt;NA&gt;
## 02020       &lt;NA&gt;   FALSE   FALSE       FALSE  complex alt.      NEG
## NA.2        &lt;NA&gt;      NA      NA          NA          &lt;NA&gt;     &lt;NA&gt;
##       fusion.protein  mdr   kinet   ccr relapse transplant  f.u
## 49006           p210  NEG dyploid FALSE    TRUE      FALSE  REL
## 57001           &lt;NA&gt;  NEG hyperd.    NA      NA         NA &lt;NA&gt;
## 62001           &lt;NA&gt;  NEG hyperd.    NA      NA         NA &lt;NA&gt;
## NA.1            &lt;NA&gt; &lt;NA&gt;    &lt;NA&gt;    NA      NA         NA &lt;NA&gt;
## 02020           &lt;NA&gt;  NEG dyploid    NA      NA         NA &lt;NA&gt;
## NA.2            &lt;NA&gt; &lt;NA&gt;    &lt;NA&gt;    NA      NA         NA &lt;NA&gt;
##       date.last.seen
## 49006      4/26/1999
## 57001           &lt;NA&gt;
## 62001           &lt;NA&gt;
## NA.1            &lt;NA&gt;
## 02020           &lt;NA&gt;
## NA.2            &lt;NA&gt;</code></pre>
<pre class="r"><code>dim(subset(pdata, idx))    # BETTER: no NA rows</code></pre>
<pre><code>## [1] 17 21</code></pre>
<pre class="r"><code>dim(subset(pdata, (sex == &quot;F&quot;) &amp; (age &gt; 40)))  # alternative</code></pre>
<pre><code>## [1] 17 21</code></pre>
<pre class="r"><code>tail(subset(pdata,idx))</code></pre>
<pre><code>##         cod  diagnosis sex age BT remission                 CR    date.cr
## 28032 28032  9/26/1998   F  52 B1        CR                 CR 10/30/1998
## 30001 30001  1/16/1997   F  54 B3      &lt;NA&gt; DEATH IN INDUCTION       &lt;NA&gt;
## 49006 49006  8/12/1998   F  43 B2        CR                 CR 11/19/1998
## 57001 57001  1/29/1997   F  53 B3      &lt;NA&gt; DEATH IN INDUCTION       &lt;NA&gt;
## 62001 62001 11/11/1997   F  50 B4       REF                REF       &lt;NA&gt;
## 02020  2020  3/23/2000   F  48 T2      &lt;NA&gt; DEATH IN INDUCTION       &lt;NA&gt;
##       t.4.11. t.9.22. cyto.normal         citog mol.biol fusion.protein
## 28032    TRUE   FALSE       FALSE       t(4;11) ALL1/AF4           &lt;NA&gt;
## 30001   FALSE    TRUE       FALSE t(9;22)+other  BCR/ABL           p190
## 49006      NA      NA          NA          &lt;NA&gt;  BCR/ABL           p210
## 57001   FALSE   FALSE        TRUE        normal      NEG           &lt;NA&gt;
## 62001   FALSE    TRUE       FALSE t(9;22)+other  BCR/ABL           &lt;NA&gt;
## 02020   FALSE   FALSE       FALSE  complex alt.      NEG           &lt;NA&gt;
##       mdr   kinet   ccr relapse transplant  f.u date.last.seen
## 28032 NEG dyploid  TRUE   FALSE      FALSE  CCR      5/16/2002
## 30001 NEG hyperd.    NA      NA         NA &lt;NA&gt;           &lt;NA&gt;
## 49006 NEG dyploid FALSE    TRUE      FALSE  REL      4/26/1999
## 57001 NEG hyperd.    NA      NA         NA &lt;NA&gt;           &lt;NA&gt;
## 62001 NEG hyperd.    NA      NA         NA &lt;NA&gt;           &lt;NA&gt;
## 02020 NEG dyploid    NA      NA         NA &lt;NA&gt;           &lt;NA&gt;</code></pre>
<pre class="r"><code>## robust `[`: exclude NA values
dim(pdata[idx &amp; !is.na(idx),])</code></pre>
<pre><code>## [1] 17 21</code></pre>
<p>Use the <code>mol.biol</code> column to subset the data to contain just individuals with ‘BCR/ABL’ or ‘NEG’, e.g.,</p>
<pre class="r"><code>bcrabl &lt;- subset(pdata, mol.biol %in% c(&quot;BCR/ABL&quot;, &quot;NEG&quot;))</code></pre>
<p>The <code>mol.biol</code> column is a factor, and retains all levels even after subsetting. It is sometimes convenient to retain factor levels, but in our case we use <code>droplevels()</code> to removed unused levels</p>
<pre class="r"><code>bcrabl$mol.biol &lt;- droplevels(bcrabl$mol.biol)</code></pre>
<p>The <code>BT</code> column is a factor describing B- and T-cell subtypes</p>
<pre class="r"><code>levels(bcrabl$BT)</code></pre>
<pre><code>##  [1] &quot;B&quot;  &quot;B1&quot; &quot;B2&quot; &quot;B3&quot; &quot;B4&quot; &quot;T&quot;  &quot;T1&quot; &quot;T2&quot; &quot;T3&quot; &quot;T4&quot;</code></pre>
<p>How might one collapse B1, B2, … to a single type B, and likewise for T1, T2, …, so there are only two subtypes, B and T? One strategy is to replace two-letter level (e.g., <code>B1</code>) with the single-letter level (e.g., <code>B</code>). Do this using <code>substring()</code> to select the first letter of level, and update the previous levels with the new value using <code>levels&lt;-</code>.</p>
<pre class="r"><code>table(bcrabl$BT)</code></pre>
<pre><code>## 
##  B B1 B2 B3 B4  T T1 T2 T3 T4 
##  4  9 35 22  9  5  1 15  9  2</code></pre>
<pre class="r"><code>levels(bcrabl$BT) &lt;- substring(levels(bcrabl$BT), 1, 1)
table(bcrabl$BT)</code></pre>
<pre><code>## 
##  B  T 
## 79 32</code></pre>
<p>Use <code>aggregate()</code> to count the number of samples with B- and T-cell types in each of the BCR/ABL and NEG groups</p>
<pre class="r"><code>aggregate(rownames(bcrabl) ~ BT + mol.biol, bcrabl, length)</code></pre>
<pre><code>##   BT mol.biol rownames(bcrabl)
## 1  B  BCR/ABL               37
## 2  B      NEG               42
## 3  T      NEG               32</code></pre>
<p>Use <code>aggregate()</code> to calculate the average age of males and females in the BCR/ABL and NEG treatment groups.</p>
<pre class="r"><code>aggregate(age ~ mol.biol + sex, bcrabl, mean)</code></pre>
<pre><code>##   mol.biol sex  age
## 1  BCR/ABL   F 39.9
## 2      NEG   F 30.4
## 3  BCR/ABL   M 40.5
## 4      NEG   M 27.2</code></pre>
<p>Use <code>t.test()</code> to compare the age of individuals in the BCR/ABL versus NEG groups; visualize the results using <code>boxplot()</code>. In both cases, use the <code>formula</code> interface. Consult the help page <code>?t.test</code> and re-do the test assuming that variance of ages in the two groups is identical. What parts of the test output change?</p>
<pre class="r"><code>t.test(age ~ mol.biol, bcrabl)</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  age by mol.biol
## t = 5, df = 69, p-value = 8e-06
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##   7.14 17.22
## sample estimates:
## mean in group BCR/ABL     mean in group NEG 
##                  40.2                  28.1</code></pre>
<pre class="r"><code>boxplot(age ~ mol.biol, bcrabl)</code></pre>
<p><img src="multivariate_leukemia_phenotype_files/figure-html/ALL-age-1.png" width="672" /></p>
</div>
<div id="multivariate-analysis" class="section level1">
<h1>Multivariate analysis</h1>
<p>This is a classic microarray experiment. Microarrays consist of ‘probesets’ that interogate genes for their level of expression. In the experiment we’re looking at, there are 12625 probesets measured on each of the 128 samples. The raw expression levels estimated by microarray assays require considerable pre-processing, the data we’ll work with has been pre-processed.</p>
<div id="input-and-setup" class="section level2">
<h2>Input and setup</h2>
<p>Start by finding the expression data file on disk.</p>
<!--

-->
<pre class="r"><code>path &lt;- file.choose()          # look for ALL-expression.csv
stopifnot(file.exists(path))</code></pre>
<p>The data is stored in ‘comma-separate value’ format, with each probeset occupying a line, and the expression value for each sample in that probeset separated by a comma. Input the data using <code>read.csv()</code>. There are three challenges:</p>
<ol style="list-style-type: decimal">
<li>The row names are present in the first column of the data. Tell <em>R</em> this by adding the argument <code>row.names=1</code> to <code>read.csv()</code>.</li>
<li>By default, <em>R</em> checks that column names do not look like numbers, but our column names <em>do</em> look like numbers. Use the argument <code>check.colnames=FALSE</code> to over-ride <em>R</em>’s default.</li>
<li><code>read.csv()</code> returns a <code>data.frame</code>. We could use a <code>data.frame</code> to work with our data, but really it is a <code>matrix()</code> – the columns are of the same type and measure the same thing. Use <code>as.matrix()</code> to coerce the <code>data.frame</code> we input to a <code>matrix</code>.</li>
</ol>
<pre class="r"><code>exprs &lt;- read.csv(path, row.names=1, check.names=FALSE)
exprs &lt;- as.matrix(exprs)
class(exprs)</code></pre>
<pre><code>## [1] &quot;matrix&quot;</code></pre>
<pre class="r"><code>dim(exprs)</code></pre>
<pre><code>## [1] 12625   128</code></pre>
<pre class="r"><code>exprs[1:6, 1:10]</code></pre>
<pre><code>##           01005 01010 03002 04006 04007 04008 04010 04016 06002 08001
## 1000_at    7.60  7.48  7.57  7.38  7.91  7.07  7.47  7.54  7.18  7.74
## 1001_at    5.05  4.93  4.80  4.92  4.84  5.15  5.12  5.02  5.29  4.63
## 1002_f_at  3.90  4.21  3.89  4.21  3.42  3.95  4.15  3.58  3.90  3.63
## 1003_s_at  5.90  6.17  5.86  6.12  5.69  6.21  6.29  5.67  5.84  5.88
## 1004_at    5.93  5.91  5.89  6.17  5.62  5.92  6.05  5.74  5.99  5.75
## 1005_at    8.57 10.43  9.62  9.94  9.98 10.06 10.66 11.27  8.81 10.17</code></pre>
<pre class="r"><code>range(exprs)</code></pre>
<pre><code>## [1]  1.98 14.13</code></pre>
<p>We’ll make use of the data describing the samples</p>
<!--

-->
<pre class="r"><code>path &lt;- file.choose()         # look for ALL-phenoData.csv
stopifnot(file.exists(path))</code></pre>
<pre class="r"><code>pdata &lt;- read.csv(path, row.names=1)
class(pdata)</code></pre>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<pre class="r"><code>dim(pdata)</code></pre>
<pre><code>## [1] 128  21</code></pre>
<pre class="r"><code>head(pdata)</code></pre>
<pre><code>##        cod diagnosis sex age BT remission CR   date.cr t.4.11. t.9.22.
## 01005 1005 5/21/1997   M  53 B2        CR CR  8/6/1997   FALSE    TRUE
## 01010 1010 3/29/2000   M  19 B2        CR CR 6/27/2000   FALSE   FALSE
## 03002 3002 6/24/1998   F  52 B4        CR CR 8/17/1998      NA      NA
## 04006 4006 7/17/1997   M  38 B1        CR CR  9/8/1997    TRUE   FALSE
## 04007 4007 7/22/1997   M  57 B2        CR CR 9/17/1997   FALSE   FALSE
## 04008 4008 7/30/1997   M  17 B1        CR CR 9/27/1997   FALSE   FALSE
##       cyto.normal        citog mol.biol fusion.protein mdr   kinet   ccr
## 01005       FALSE      t(9;22)  BCR/ABL           p210 NEG dyploid FALSE
## 01010       FALSE  simple alt.      NEG           &lt;NA&gt; POS dyploid FALSE
## 03002          NA         &lt;NA&gt;  BCR/ABL           p190 NEG dyploid FALSE
## 04006       FALSE      t(4;11) ALL1/AF4           &lt;NA&gt; NEG dyploid FALSE
## 04007       FALSE      del(6q)      NEG           &lt;NA&gt; NEG dyploid FALSE
## 04008       FALSE complex alt.      NEG           &lt;NA&gt; NEG hyperd. FALSE
##       relapse transplant               f.u date.last.seen
## 01005   FALSE       TRUE BMT / DEATH IN CR           &lt;NA&gt;
## 01010    TRUE      FALSE               REL      8/28/2000
## 03002    TRUE      FALSE               REL     10/15/1999
## 04006    TRUE      FALSE               REL      1/23/1998
## 04007    TRUE      FALSE               REL      11/4/1997
## 04008    TRUE      FALSE               REL     12/15/1997</code></pre>
<p>Some of the results below involve plots, and it’s convenient to choose pretty and functional colors. We use the <a href="https://cran.r-project.org/?package=RColorBrewer">RColorBrewer</a> package; see <a href="http://colorbrewer.org">colorbrewer.org</a></p>
<pre class="r"><code>library(RColorBrewer)  ## not available? install package via RStudio
highlight &lt;- brewer.pal(3, &quot;Set2&quot;)[1:2]</code></pre>
<p>`highlight’ is a vector of length 2, light and dark green.</p>
<p>For more options see <code>?RColorBrewer</code> and to view the predefined palettes <code>display.brewer.all()</code></p>
</div>
<div id="cleaning" class="section level2">
<h2>Cleaning</h2>
<p>We’ll add a column to <code>pdata</code>, derived from the <code>BT</code> column, to indicate whether the sample is B-cell or T-cell ALL.</p>
<pre class="r"><code>pdata$BorT &lt;- factor(substr(pdata$BT, 1, 1))</code></pre>
<p>Microarray expression data is usually represented as a matrix of genes as rows and samples as columns. Statisticians usually think of their data as samples as rows, features as columns. So we’ll transpose the expression values</p>
<pre class="r"><code>exprs &lt;- t(exprs)</code></pre>
<p>Confirm that the <code>pdata</code> rows correspond to the <code>exprs</code> rows.</p>
<pre class="r"><code>stopifnot(identical(rownames(pdata), rownames(exprs)))</code></pre>
</div>
<div id="unsupervised-machine-learning-multi-dimensional-scaling" class="section level2">
<h2>Unsupervised machine learning – multi-dimensional scaling</h2>
<p>Reduce high-dimensional data to lower dimension for visualization.</p>
<p>Calculate distance between <em>samples</em> (requires that the expression matrix be transposed).</p>
<pre class="r"><code>d &lt;- dist(exprs)</code></pre>
<p>Use the <code>cmdscale()</code> function to summarize the distance matrix into two points in two dimensions.</p>
<pre class="r"><code>cmd &lt;- cmdscale(d)</code></pre>
<p>Visualize the result, coloring points by B- or T-cell status</p>
<pre class="r"><code>plot(cmd, col=highlight[pdata$BorT])</code></pre>
<p><img src="multivariate_leukemia_phenotype_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
</div>

    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-93043521-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
